$(document).on("click", ".addtowishlist, .removetowishlist", function (event) {
    event.stopPropagation();

    var icon = $(this);
    var productid = icon.data("productid");
    var flag = icon.data("flag");

    $.ajax({
        type: "POST",
        url: '/Product/AddToWishlist',
        data: { productId: productid, flag: flag },
        success: function (response) {
            if (response.success) {
                if (flag === "add") {
                    toastr.success('Product Added To Wishlist!', "Success");
                    icon.removeClass("bi-heart addtowishlist")
                        .addClass("bi-heart-fill removetowishlist")
                        .css("color", "rgba(0, 102, 167, 1)")
                        .data("flag", "remove");
                } else {
                    toastr.success('Product Removed From Wishlist!', "Success");
                    icon.removeClass("bi-heart-fill removetowishlist")
                        .addClass("bi-heart addtowishlist")
                        .removeAttr("style")
                        .data("flag", "add");
                }
            } else {
                alert("Failed to update Wishlist");
            }
        },
        error: function (xhr, status, error) {
            console.error(xhr);
        }
    });
});
