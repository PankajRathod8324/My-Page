private static byte[] GeneratePdfFromHtml(string htmlContent)
{
    using var outputStream = new MemoryStream();
    using var htmlStream = new MemoryStream(System.Text.Encoding.UTF8.GetBytes(htmlContent));

    using var pdfWriter = new iText.Kernel.Pdf.PdfWriter(outputStream);
    using var pdfDocument = new iText.Kernel.Pdf.PdfDocument(pdfWriter);

    iText.Html2pdf.HtmlConverter.ConvertToPdf(htmlStream, pdfDocument);

    pdfDocument.Close(); // Ensure PDF is finalized before reading

    return outputStream.ToArray();
}
