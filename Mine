public IActionResult AddCustomerDetail([FromBody] JsonObject customerdata)
{
    try
    {
        // Extract customer details from JSON
        string email = (string)customerdata["email"];
        string name = (string)customerdata["Name"];
        string phone = (string)customerdata["Phone"];
        int noOfPerson = (int)customerdata["noOfPerson"];
        List<Table> selectedTables = new List<Table>();

        if (customerdata.ContainsKey("SelectedTable") && customerdata["SelectedTable"] != null)
        {
            selectedTables = JsonConvert.DeserializeObject<List<Table>>(customerdata["SelectedTable"].ToString());
        }

        // Check if the customer already exists
        var existingCustomer = _context.Customers.FirstOrDefault(c => c.Email == email);

        if (existingCustomer != null)
        {
            // Customer exists -> Update NoOfPerson
            existingCustomer.Noofperson = noOfPerson;
            _context.SaveChanges();

            // Add selected tables to the CustomerTable relation
            foreach (var table in selectedTables)
            {
                var customerTable = new CustomerTable
                {
                    CustomerId = existingCustomer.Id,
                    TableId = table.TableId
                };
                _context.CustomerTables.Add(customerTable);
            }
        }
        else
        {
            // Customer does not exist -> Insert new customer
            var newCustomer = new Customer
            {
                Email = email,
                Name = name,
                Phone = phone,
                Noofperson = noOfPerson
            };
            _context.Customers.Add(newCustomer);
            _context.SaveChanges(); // Save to generate Customer ID

            // Add selected tables to the CustomerTable relation
            foreach (var table in selectedTables)
            {
                var customerTable = new CustomerTable
                {
                    CustomerId = newCustomer.Id,
                    TableId = table.TableId
                };
                _context.CustomerTables.Add(customerTable);
            }
        }

        _context.SaveChanges(); // Save all changes

        return Json(new { success = true, message = "Customer Added Successfully!" });
    }
    catch (Exception ex)
    {
        return Json(new { success = false, message = "An error occurred: " + ex.Message });
    }
}
