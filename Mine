// Collect selected branch IDs
let selectedBranchIds = [];
document.querySelectorAll(".toggle-branch.btn-success").forEach(btn => {
    selectedBranchIds.push(btn.getAttribute("data-branch-id"));
});
submissionData.append("SelectedBranchIds", selectedBranchIds.join(','));
public void UpdateCategoryBranches(int categoryId, List<int> selectedBranchIds)
{
    // Remove existing links
    var existingMappings = _context.CategoryBranchMappings.Where(cb => cb.Categoryid == categoryId).ToList();
    _context.CategoryBranchMappings.RemoveRange(existingMappings);
    _context.SaveChanges();

    // Add new links
    var newMappings = selectedBranchIds.Select(branchId => new CategoryBranchMapping
    {
        Categoryid = categoryId,
        Branchid = branchId
    }).ToList();

    _context.CategoryBranchMappings.AddRange(newMappings);
    _context.SaveChanges();
}
