  private static byte[] GeneratePdfFromHtml(string htmlContent)
    {
        using var ms = new MemoryStream();

        // Use iText7 to convert HTML to PDF
        using (var writer = new PdfWriter(ms))
        {
            var pdfDocument = new PdfDocument(writer);
            using var document = new iText.Layout.Document(pdfDocument);
            var paragraph = new iText.Layout.Element.Paragraph(htmlContent);
            document.Add(paragraph);
            document.Close();
        }

        return ms.ToArray();
    }
