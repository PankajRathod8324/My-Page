OrderItems = o.OrderStatus == "Ready" 
? o.OrderItems.Select(oi => new OrderItemVM
{
    ItemId = (int)oi.ItemId,
    ItemName = _context.MenuItems.Where(mi => mi.ItemId == oi.ItemId).Select(mi => mi.ItemName).FirstOrDefault(),
    Price = oi.Rate,
    Quantity = oi.Quantity,
    ItemInstructions = oi.ItemInstructions,
    Status = "Ready",
    Modifiers = oi.OrderModifiers.Select(om => new OrderModifierVM
    {
        ModifierId = (int)om.ModifierId,
        ModifierName = _context.MenuModifiers.Where(mod => mod.ModifierId == om.ModifierId).Select(mod => mod.ModifierName).FirstOrDefault(),
        ModifierRate = om.Rate,
        Quantity = om.Quantity
    }).ToList()
}).ToList()
: o.OrderItems.SelectMany(oi => new List<OrderItemVM>
{
    // Ready Item
    oi.Readyitemquantity > 0 ? new OrderItemVM
    {
        ItemId = (int)oi.ItemId,
        ItemName = _context.MenuItems.Where(mi => mi.ItemId == oi.ItemId).Select(mi => mi.ItemName).FirstOrDefault(),
        Price = oi.Rate,
        Quantity = oi.Readyitemquantity,
        ItemInstructions = oi.ItemInstructions,
        Status = "Ready",
        Modifiers = oi.OrderModifiers.Select(om => new OrderModifierVM
        {
            ModifierId = (int)om.ModifierId,
            ModifierName = _context.MenuModifiers.Where(mod => mod.ModifierId == om.ModifierId).Select(mod => mod.ModifierName).FirstOrDefault(),
            ModifierRate = om.Rate,
            Quantity = om.Quantity
        }).ToList()
    } : null,

    // In Progress Item
    (oi.Quantity - oi.Readyitemquantity) > 0 ? new OrderItemVM
    {
        ItemId = (int)oi.ItemId,
        ItemName = _context.MenuItems.Where(mi => mi.ItemId == oi.ItemId).Select(mi => mi.ItemName).FirstOrDefault(),
        Price = oi.Rate,
        Quantity = oi.Quantity - oi.Readyitemquantity,
        ItemInstructions = oi.ItemInstructions,
        Status = "In Progress",
        Modifiers = oi.OrderModifiers.Select(om => new OrderModifierVM
        {
            ModifierId = (int)om.ModifierId,
            ModifierName = _context.MenuModifiers.Where(mod => mod.ModifierId == om.ModifierId).Select(mod => mod.ModifierName).FirstOrDefault(),
            ModifierRate = om.Rate,
            Quantity = om.Quantity
        }).ToList()
    } : null
}).Where(x => x != null).ToList(),
