
            // Column Headers
            worksheet.Cell(11, 1).Value = "Order ID";
            worksheet.Range("B9:D9").Merge();
            worksheet.Cell(11, 5).Value = "Date";
            worksheet.Range("E9:G9").Merge();
            worksheet.Cell(11, 8).Value = "Customer";
            worksheet.Range("H9:J9").Merge();
            worksheet.Cell(11, 11).Value = "Status";
            worksheet.Range("K9:L9").Merge();
            worksheet.Cell(11, 13).Value = "Payment Mode";
            worksheet.Range("M9:N9").Merge();
            worksheet.Cell(11, 15).Value = "Rating";
            worksheet.Range("O9:P9").Merge();
            worksheet.Cell(11, 17).Value = "Total Amount";

            int row = 12; // Start writing data from row 4
            foreach (var order in orders)
            {
                worksheet.Cell(row, 1).Value = order.OrderId;
                worksheet.Range("B" + row + ":D" + row).Merge();
                worksheet.Cell(row, 5).Value = order.Date.ToString("yyyy-MM-dd");
                worksheet.Range("E" + row + ":G" + row).Merge();
                worksheet.Cell(row, 8).Value = order.CustomerId.HasValue ? _orderService.GetCustomerById(order.CustomerId.Value) : "No Customer";
                worksheet.Range("H" + row + ":J" + row).Merge();
                worksheet.Cell(row, 11).Value = order.OrderStatusId.HasValue ? _orderService.GetOrderStatusById(order.OrderStatusId.Value) : "No Order Status";
                worksheet.Range("K" + row + ":L" + row).Merge();
                worksheet.Cell(row, 13).Value = order.PaymentModeId.HasValue ? _orderService.GetPaymentModeById(order.PaymentModeId.Value) : "No Payment Mode";
                worksheet.Range("M" + row + ":N" + row).Merge();
                worksheet.Cell(row, 15).Value = order.ReviewId.HasValue ? _orderService.GetReviewById(order.ReviewId.Value) : 0;
                worksheet.Range("O" + row + ":P" + row).Merge();
                worksheet.Cell(row, 17).Value = order.TotalAmount;
                // worksheet.Cell(row, 3).Value = order.OrderStatus.OrderStatusName;
                row++;
            }

            // Set column widths
            worksheet.Columns().AdjustToContents();

            // Save to memory stream
            using (var stream = new MemoryStream())
            {
                workbook.SaveAs(stream);
                var content = stream.ToArray();
                return File(content, "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", "Orders.xlsx");
            }
        }
