  public List<OrderVM> GetOrderCategoryItem(int categoryId, string? status)
    {
        var orders = _accountmanagerorderapprepository.GetOrderCategoryItem(categoryId, status);

        var orderVms = orders.Select(o => new OrderVM
        {
            OrderId = o.OrderId,
            OccupiedTime = DateTime.UtcNow - o.CreatedAt,
            OrderInstruction = o.OrderInstructions,
            OrderItems = o.OrderItems
            .Where(oi => oi.ItemId != 0 &&
                  ((status == "In Progress" && (oi.Quantity - oi.Readyitemquantity) > 0) ||
                  (status != "In Progress" && oi.Readyitemquantity > 0)))
            .Select(oi => new OrderItemVM
            {
                ItemId = (int)oi.ItemId,
                ItemName = oi.ItemId.HasValue ? _menuRepository.GetItemNameById((int)oi.ItemId) : "No Item", // This should be populated from SP
                Price = oi.Rate,
                Quantity = (status == "In Progress") ? (oi.Quantity - oi.Readyitemquantity) : oi.Readyitemquantity,
                ItemInstructions = oi.ItemInstructions,
                Status = status,
                Modifiers = oi.OrderModifiers.Select(om => new OrderModifierVM
                {
                    ModifierId = (int)om.ModifierId,
                    ModifierName = om.ModifierId.HasValue ? _menuRepository.GetModifierNameById((int)om.ModifierId).ToString() : "No Modifier", // From SP
                    ModifierRate = om.ModifierId.HasValue ? _menuRepository.GetModifierPriceById((int)om.ModifierId) : 0m, // From SP,
                    Quantity = 1
                }).ToList()
            }).ToList(),

            CustomerTables = _accountmanagerorderapprepository.GetTablesByCustomerId((int)o.CustomerId).Select(ct => new CustomerTableVM
            {
                TableId = (int)ct.TableId,
                TableName = ct.TableId.HasValue ? _tableRepository.GetTableNameByTableId((int)ct.TableId) ?? "No Table" : "No Table",
                SectionName = ct.TableId.HasValue ? _tableRepository.GetSectionNameByTableId((int)ct.TableId) : "No Section"
            }).ToList()
        })
        .Where(o => o.OrderItems.Count > 0)
        .ToList();

        return orderVms;
    }
