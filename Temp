public IActionResult ExportToPDF(int orderId)
{
    var order = _orderService.GetOrderById(orderId);
    if (order == null)
    {
        return NotFound("Order not found");
    }

    try
    {
        // Create a new MemoryStream without a using statement
        var memoryStream = new MemoryStream();

        // Initialize the PdfWriter and PdfDocument
        var writer = new PdfWriter(memoryStream);
        var pdf = new PdfDocument(writer);
        var document = new Document(pdf);

        // Add content to the PDF
        document.Add(new Paragraph("Order Details").SetFontSize(18));
        document.Add(new Paragraph($"Order ID: {order.OrderId}"));
        document.Add(new Paragraph($"Date: {order.Date:yyyy-MM-dd}"));
        document.Add(new Paragraph($"Status: {order.OrderStatus}"));
        document.Add(new Paragraph($"Total Amount: {order.TotalAmount:C}"));

        // Close the document to finalize the PDF
        document.Close();

        // Reset the memory stream position to the beginning
        memoryStream.Position = 0;

        // Return the PDF file; the framework will handle the stream disposal
        return File(memoryStream, "application/pdf", $"Order_{orderId}.pdf");
    }
    catch (Exception ex)
    {
        return BadRequest($"Error generating PDF: {ex.Message}");
    }
}
