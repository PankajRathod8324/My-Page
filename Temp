public async Task<IActionResult> ExportToPDF(int orderId)
{
    var order = _orderService.GetOrderById(orderId);
    if (order == null)
    {
        return NotFound("Order not found");
    }

    try
    {
        // Set the response content type to PDF
        Response.ContentType = "application/pdf";
        // Suggest a file name for the downloaded PDF
        Response.Headers.Add("Content-Disposition", $"attachment; filename=Order_{orderId}.pdf");

        // Initialize the PdfWriter with the response body stream
        using (var writer = new PdfWriter(Response.Body))
        {
            var pdf = new PdfDocument(writer);
            var document = new Document(pdf);

            // Add content to the PDF
            document.Add(new Paragraph("Order Details").SetFontSize(18));
            document.Add(new Paragraph($"Order ID: {order.OrderId}"));
            document.Add(new Paragraph($"Date: {order.Date:yyyy-MM-dd}"));
            document.Add(new Paragraph($"Status: {order.OrderStatus}"));
            document.Add(new Paragraph($"Total Amount: {order.TotalAmount:C}"));

            // Close the document to finalize the PDF
            document.Close();
        }

        // Since we're writing directly to the response stream, return an empty result
        return new EmptyResult();
    }
    catch (Exception ex)
    {
        return BadRequest($"Error generating PDF: {ex.Message}");
    }
}
